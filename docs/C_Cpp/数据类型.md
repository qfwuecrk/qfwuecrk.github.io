# C语言数据类型

## 数据类型

``` mermaid
graph LR
    A[数据类型] --> B[基本类型];

    B[基本类型] --> C[整型];
    C --> C1[整型 int];
    C --> C2[短整型 short];
    C --> C3[长整型 long];

    B[基本类型] --> D[浮点型];
    D --> D1[单精度浮点型 float];
    D --> D2[双精度浮点型 double];

    B[基本类型] --> E[字符类型 char];
    
    A --> F[构造类型];
    F --> F1[数组 array];
    F --> F2[结构体 struct];
    F --> F3[共用体 union];
    F --> F4[枚举类型 enum];

    A --> G[指针类型 *];
    A --> H[空类型 void];
```

## 数据范围

| 类型 | 符号 | 关键字 | 所占位数 | 数的表示范围 |
|:-:|:-:|:-:|:-:|:-:|
| 整型 | 有 | (signed) int | 32 | -2147483648 ~ 2147483647 |
| 整型 | 有 | (signed) short | 16 | -32768 ~ 32767 |
| 整型 | 有 | (signed) long | 32 | -2147483648 ~ 2147483647 |
| 整型 | 无 | unsigned int | 32 | 0 ~ 4294967295 |
| 整型 | 无 | unsigned short | 16 | 0 ~ 65535 |
| 整型 | 无 | unsigned long | 32 | 0 ~ 4294967295 |
| 实型 | 有 | float | 32 | 3.4e-38 ~ 3.4e38 |
| 实型 | 有 | double | 64 | 1.7e-308 ~ 1.7e308 |
| 字符型 | 有 | char | 8 | -128 ~ 127 |
| 字符型 | 无 | unsigned char | 8 | 0 ~ 255 |

- 数据类型所占字节数随机器硬件不同而不同，上表以IBM PC机为例。
- 标准C中对任何一种数据类型的字节大小（所占位数）并没有严格意义上的规定。
- 标准C中以int类型作为基准，int类型占一个机器字长，char型小于int类型。float类型和double类型大于int类型。
- 标准C中只有大小范围的规定，并没有规定数据类型一定的字节数。
- 当前8位一个字节，一个字长32位、4个字节。

## 所占字节
- char型一般占一个字节8位；
- int一般占一个字长，4个字节32位；
- short型占2个字节16位；
- long型和float型一般与int一样大；
- double类型相当于两个float类型64位。

### 运算
- 整数按照补码形式存储后，所有的运算都是加法。
- 减法等价于加负数。
- 乘法是多次加法。
- 除法是多次减法。

## 存储区别
- C语言标准中针对数值常量，规定了八进制、十进制和十六进制。但是对二进制没有规定。
```c
int n = 0;
n = b1011;      /* 这是错的，虽然b开头表示二进制，但是不识别    */
n = 0b1011;     /* 有些编译器厂商实现了0b的二进制表达           */
n = 017;        /* 正确，识别为八进制，以0开头                  */
n = 0xFF;       /* 正确，识别为十六进制，以0x开头               */
```
- 整数类型的存储
    - 整数类型以二进制补码存储在内存中。
    - 补码：正数的补码就是其二进制码本身；负数的补码是其绝对值的二进制码取反加1。
    ```
        254 -> unsigned int -> 32位
        (254)10 = (11111110)2 = (376)8 = (FE)16

        254             十进制
        B11111110       二进制，前缀B
        0376            八进制，前缀0
        0xFE            十六进制，前缀0x
    ```
- 浮点类型的存储
    - 浮点数存储时，整数部分为0
    - float类型浮点数3.14表示为 0.314 * 10^1
    - 浮点数存储时，整数部分为0，存储时由【符号位】【指数部分】【精度（小数）部分】三部分组成。
    - double类型多出来的部分放在精度控制上。
    ```
        32位float构成
        -------------------------------------------------------------
             31      30            23   22                       0
        [(1位符号位)(    8位指数部分   )(    23位精度部分或小数部分   )]
    ```

- 字符类型的存储
    - char类型存储和整型数一样，以二进制补码存储。
    - 在标准C中，char类型有无符号是未定义的。
    - ASCII码中第一个字符是空，NULL，也是字符串的尾0。该字符编号为0。
    - ASCII的数值从0开始，使用有符号的char是因为曾经用char类型当作短小精悍的整型运行。曾经的计算机硬件跟不上软件发展，存储空间吃紧。
    - 标准C中规定的是0 ~ 127个字符，后来补充到了255。共256个。

## 不同类型的数据间进行转换
- 隐式类型转换
    - 不同类型运算时，会自动向所占字节数多的或是精度比较高的靠拢。
    ```
        (char + int) - (float + double)
             int     -      double
                   double
    ```
- 显式类型转换（强制类型转换）

## 特殊性
- 布尔型bool
    - 是一个逻辑型，在新的C标准中加入的数据类型。一般可以用整型值代替。
    - true 用1表示 和 false 用0表示
    - 头文件 #include <stdbool.h>
- float类型
    - 其只能表达一个范围，不能表达非常精确的值。
    - 判断float类型数是否等于0，不能直接判断，要与0做减法判断差值是否小于很小的数，比如1e-6。
    ```c
        // (f == 0) =====> ( |f - 0| <= 1e-6 )
        if (fabs(f - 0) <= 1e-6)
        {
            return 1;
        }
    ```
- char类型有无符号未定义
- 不同形式的0值
    - '0' "0" '\0' NULL
- 数据类型与后续代码中所使用的输入输出要相匹配
    - 例如 int 使用 %d，要互相匹配，不要自相矛盾。